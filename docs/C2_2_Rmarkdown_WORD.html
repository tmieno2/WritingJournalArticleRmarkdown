<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.382">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reproducible Journal Articles using R with Rmarkdown/Quarto - 7&nbsp; Rmarkdown-WORD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./C2_3_Rmarkdown_PDF.html" rel="next">
<link href="./C2_1_IntroWriting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./C2_1_IntroWriting.html">Manuscript Writing</a></li><li class="breadcrumb-item"><a href="./C2_2_Rmarkdown_WORD.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rmarkdown-WORD</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible Journal Articles using R with Rmarkdown/Quarto</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Reproducible Research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C0_0_ReproducibleResearch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Project Setup</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1_0_IntroProject.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1_1_ProjectOrganization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1_2_DevelopProject.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Project Development</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1_3_VersionControl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Version Control (Recommended, but optional)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Manuscript Writing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_1_IntroWriting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_2_Rmarkdown_WORD.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rmarkdown-WORD</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_3_Rmarkdown_PDF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rmarkdown-PDF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_4_Quarto_PDF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Quarto-PDF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_5_KnitrLatex_PDF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">PDF using <code>knitr</code> and Latex</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C_End_References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#before-you-start" id="toc-before-you-start" class="nav-link active" data-scroll-target="#before-you-start"><span class="header-section-number">7.1</span> Before you start</a></li>
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation"><span class="header-section-number">7.2</span> Preparation</a></li>
  <li><a href="#basic-workflow-until-publication" id="toc-basic-workflow-until-publication" class="nav-link" data-scroll-target="#basic-workflow-until-publication"><span class="header-section-number">7.3</span> Basic workflow until publication</a></li>
  <li><a href="#structure-of-the-rmarkdown-file" id="toc-structure-of-the-rmarkdown-file" class="nav-link" data-scroll-target="#structure-of-the-rmarkdown-file"><span class="header-section-number">7.4</span> Structure of the Rmarkdown file</a>
  <ul class="collapse">
  <li><a href="#yaml-header" id="toc-yaml-header" class="nav-link" data-scroll-target="#yaml-header"><span class="header-section-number">7.4.1</span> YAML header</a></li>
  <li><a href="#main-body" id="toc-main-body" class="nav-link" data-scroll-target="#main-body"><span class="header-section-number">7.4.2</span> Main body</a></li>
  </ul></li>
  <li><a href="#essential-markdown-syntaxes-for-word" id="toc-essential-markdown-syntaxes-for-word" class="nav-link" data-scroll-target="#essential-markdown-syntaxes-for-word"><span class="header-section-number">7.5</span> Essential markdown syntaxes for WORD</a></li>
  <li><a href="#sec-word-specify-style" id="toc-sec-word-specify-style" class="nav-link" data-scroll-target="#sec-word-specify-style"><span class="header-section-number">7.6</span> Specifying the style</a>
  <ul class="collapse">
  <li><a href="#sec-change-style-yaml" id="toc-sec-change-style-yaml" class="nav-link" data-scroll-target="#sec-change-style-yaml"><span class="header-section-number">7.6.1</span> Change styles in the YAML header</a></li>
  <li><a href="#sec-change-style-reference" id="toc-sec-change-style-reference" class="nav-link" data-scroll-target="#sec-change-style-reference"><span class="header-section-number">7.6.2</span> Change styles through reference docx</a></li>
  <li><a href="#style-change-example" id="toc-style-change-example" class="nav-link" data-scroll-target="#style-change-example"><span class="header-section-number">7.6.3</span> Style change example</a></li>
  </ul></li>
  <li><a href="#citations-and-references" id="toc-citations-and-references" class="nav-link" data-scroll-target="#citations-and-references"><span class="header-section-number">7.7</span> Citations and References</a>
  <ul class="collapse">
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up"><span class="header-section-number">7.7.1</span> Set up</a></li>
  <li><a href="#cite-and-create-references" id="toc-cite-and-create-references" class="nav-link" data-scroll-target="#cite-and-create-references"><span class="header-section-number">7.7.2</span> Cite and create references</a></li>
  <li><a href="#citation-and-reference-style" id="toc-citation-and-reference-style" class="nav-link" data-scroll-target="#citation-and-reference-style"><span class="header-section-number">7.7.3</span> Citation and Reference Style</a></li>
  </ul></li>
  <li><a href="#cross-ref-table-word" id="toc-cross-ref-table-word" class="nav-link" data-scroll-target="#cross-ref-table-word"><span class="header-section-number">7.8</span> Tables (Cross-referenced)</a>
  <ul class="collapse">
  <li><a href="#packages-to-create-tables" id="toc-packages-to-create-tables" class="nav-link" data-scroll-target="#packages-to-create-tables"><span class="header-section-number">7.8.1</span> Packages to create tables</a></li>
  </ul></li>
  <li><a href="#figures-cross-referenced" id="toc-figures-cross-referenced" class="nav-link" data-scroll-target="#figures-cross-referenced"><span class="header-section-number">7.9</span> Figures (Cross-referenced)</a>
  <ul class="collapse">
  <li><a href="#figures-created-internally" id="toc-figures-created-internally" class="nav-link" data-scroll-target="#figures-created-internally"><span class="header-section-number">7.9.1</span> Figures created internally</a></li>
  <li><a href="#importing-pre-made-figures" id="toc-importing-pre-made-figures" class="nav-link" data-scroll-target="#importing-pre-made-figures"><span class="header-section-number">7.9.2</span> Importing pre-made figures</a></li>
  </ul></li>
  <li><a href="#mathematical-equations" id="toc-mathematical-equations" class="nav-link" data-scroll-target="#mathematical-equations"><span class="header-section-number">7.10</span> Mathematical equations</a>
  <ul class="collapse">
  <li><a href="#math-equation" id="toc-math-equation" class="nav-link" data-scroll-target="#math-equation"><span class="header-section-number">7.10.1</span> Math equation</a></li>
  <li><a href="#in-line-math" id="toc-in-line-math" class="nav-link" data-scroll-target="#in-line-math"><span class="header-section-number">7.10.2</span> In-line math</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./C2_1_IntroWriting.html">Manuscript Writing</a></li><li class="breadcrumb-item"><a href="./C2_2_Rmarkdown_WORD.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rmarkdown-WORD</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-word" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rmarkdown-WORD</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="before-you-start" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="before-you-start"><span class="header-section-number">7.1</span> Before you start</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What you need to know/learn
</div>
</div>
<div class="callout-body-container callout-body">
<p>To author a full journal article without using WORD, you’ll need to acquire or have familiarity with the following skills:</p>
<ul>
<li>How Rmarkdown works (<a href="https://rmarkdown.rstudio.com/lesson-1.html">This</a> or <a href="https://bookdown.org/yihui/rmarkdown/basics.html">This</a> is a good place to start)</li>
<li>How to write mathematical expressions using Latex(-like) syntax (<a href="https://www.overleaf.com/learn/latex/Mathematical_expressions">This</a> can be a good start)</li>
<li>Create figures using R (any R package, like <code>ggplot2</code>)</li>
<li>Create tables using R with select R packages that are compatible with WORD output (e.g., <code>flextable</code>, <code>modelsummary</code>, <code>gtsummary</code>)</li>
</ul>
</div>
</div>
<p>Before delving into this chapter, carefully consider the time and effort required to master these skills. Ensure the investment aligns with your goals and priorities.</p>
</section>
<section id="preparation" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="preparation"><span class="header-section-number">7.2</span> Preparation</h2>
<p>Before diving in, please do the followings:</p>
<ul>
<li><p>Go <a href="https://www.dropbox.com/sh/kamcegpis7m0pzq/AAAdZ2eo1vhaZ7srxDLNHdMoa?dl=0">here</a> and download all the files including <strong>sample_to_word.rmd</strong>, which we refer to as the sample rmd file throughout this chapter.</p></li>
<li><p>Alternatively, you can clone this <a href="https://github.com/tmieno2/WritingJournalArticleRmarkdown">Github repository</a> and go to the <strong>Resources/WORD-Rmarkdown/</strong> folder.</p></li>
<li><p>Open RStudio (or any other software you you may be using like VS code) and knit <strong>sample_to_word.rmd</strong> to produce <strong>sample_to_word.docx</strong>, which we refer to as the sample WORD file.</p></li>
<li><p>Install the following packages if you have not</p>
<ul>
<li><code>officedown</code></li>
<li><code>flextable</code></li>
<li><code>officer</code></li>
<li><code>knitr</code></li>
<li><code>Rmarkdown</code></li>
<li><code>tidyverse</code></li>
<li><code>modelsummary</code></li>
</ul></li>
</ul>
</section>
<section id="basic-workflow-until-publication" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="basic-workflow-until-publication"><span class="header-section-number">7.3</span> Basic workflow until publication</h2>
<p>Here are the proposed steps to generate a fully publication-ready article:</p>
<ol type="1">
<li>Write an Rmarkdown file and knit to a WORD file without worrying about formatting your manuscript (Most journals do not require manuscript formatting until the manuscript is accepted. But, please do check yourself if it is required)</li>
<li>Iterate between the authors until ready for submission</li>
<li>Submit your manuscript (no formatting just yet)</li>
<li>Revise and resubmit your manuscript after iterating between the authors (the same as step 2)</li>
<li>Repeat steps 2, 3, and 4 until accepted (terminate the process if rejected)</li>
<li>Finally, format your manuscript to the specific requirements by the journal
<ul>
<li>create a style reference WORD file and refer to it (see Section <a href="#sec-word-specify-style" class="quarto-xref"><span>Section&nbsp;7.6</span></a>).</li>
<li>modify the format manually on WORD if that is faster</li>
</ul></li>
</ol>
<p>Now, let’s take a closer look at Step 2. What you do in this step differs based on who your co-authors are.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case 1: one of your co-authors demands a WORD file for editing for him/herself
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>In this scenario, you start by converting your text to a WORD file and sharing it with the authors. They can then edit the document in WORD. Afterward, you need to apply the suggested changes from the WORD file back to the Rmarkdown file. This final step is necessary because you are not exclusively writing in WORD. Although it may seem like an additional task, I personally do not find it burdensome. On the contrary, it ensures that I thoroughly review all modifications made by co-authors, which is essential regardless of the software used.</p></li>
<li><p>Once you modify the Rmarkdown file and knit to WORD, all the track changes will be lost. For the co-authors who want to see the changes you made from the previous version, simply suggest taking advantage of WORD’s capability to compare two versions of a document (see <a href="https://www.businessinsider.com/guides/tech/how-to-compare-two-word-documents">here</a>). If they complain about doing this, just stop working with them entirely.</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case 2: every single one of the authors knows how to use Rmarkdown and git
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this case, things are just so much easier. You never have to get out of Rmarkdown. Just let them edit the Rmarkdown file and keep track of changes using git. Any IDE should give you a side-by-side comparison of the previous and current versions like below (<a href="https://www.sublimemerge.com/">Sublime Merge</a> is used here).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-1" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/git-illustrate.png" id="fig-539a35d47e664c97a50115a146a7f1bd-1" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="structure-of-the-rmarkdown-file" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="structure-of-the-rmarkdown-file"><span class="header-section-number">7.4</span> Structure of the Rmarkdown file</h2>
<p>An Ramrkdown file consists mainly of two components.</p>
<ul>
<li>YAML header</li>
<li>Main body</li>
</ul>
<section id="yaml-header" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="yaml-header"><span class="header-section-number">7.4.1</span> YAML header</h3>
<p>YAML header comes at the very top of the Rmarkdown file and it lets you specify things like</p>
<ul>
<li>paper title</li>
<li>authors (with affiliations and other subsidiary information)</li>
<li>date</li>
<li>abstract</li>
</ul>
<p>It also lets you specify various aspects of the output word file including</p>
<ul>
<li>whether to include table of contents (<code>toc</code>)</li>
<li>the depth of table of contents (<code>toc_depth</code>)</li>
<li>whether to number sections or not (<code>number_sections</code>)</li>
<li>how to display plots and tables (<code>plots</code>, <code>tables</code>)
<ul>
<li>alignment (<code>align</code>)</li>
<li>prefix (<code>pre</code>), etc</li>
</ul></li>
</ul>
<p>This is also where you specify what files you use as bibliography, citation style, among other things. Important ones will be introduced later.</p>
<p>Here is an example YAML header, which you can see in <code>sample_to_word.rmd</code> file.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-2" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/yaml-example.png" id="fig-539a35d47e664c97a50115a146a7f1bd-2" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>More detailed explanation of output options will be provided later individually when the relevant topics are discussed.</p>
</section>
<section id="main-body" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="main-body"><span class="header-section-number">7.4.2</span> Main body</h3>
<p>This is everything that is below the YAML header, where narratives and R codes are written.</p>
</section>
</section>
<section id="essential-markdown-syntaxes-for-word" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="essential-markdown-syntaxes-for-word"><span class="header-section-number">7.5</span> Essential markdown syntaxes for WORD</h2>
<p>Here are the essential markdown syntaxes you should know. For other syntaxes such as creating a list, please refer to section <a href="C2_1_IntroWriting.html#sec-markdown-basics" class="quarto-xref"><span>Section&nbsp;6.5</span></a>.</p>
<p><strong>Section, subsection, subsubsections, …</strong></p>
<p>You can define sections, subsections, and subsubsections by using #, ##, and ### respectively at the beginning of a line.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a># This becomes section title</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>## This becomes subsection title</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>### This becomes subsubsection title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Confirm that <code># Materials and Methods</code> and <code>## Data</code> in <strong>sample_to_word.rmd</strong> turn into a section and subsection title in <strong>sample_to_word.docx</strong>.</li>
<li>Note also that the sections and subsections are automatically numbered because <code>number_sections: true</code> in the YAML header.</li>
</ul>
</div>
</div>
<p><strong>Footnote</strong></p>
<p>You can add a footnote using <code>^[]</code> like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>regular texts^[this is a footnote]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Footnotes are automatically numbered.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>See the <strong>Conclusion</strong> section of <strong>sample_to_word.rmd</strong> and <strong>sample_to_word.docx</strong>.</p>
</div>
</div>
<hr>
<p><strong>Page break</strong></p>
<p>For introducing a page break, you can place the following R chunk.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>`r run_pagebreak()`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To see this in action, examine the end of the Introduction section in the sample Rmarkdown and corresponding WORD files.</p>
</div>
</div>
</section>
<section id="sec-word-specify-style" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="sec-word-specify-style"><span class="header-section-number">7.6</span> Specifying the style</h2>
<p>You can change the style of the output WORD file either via direct control in the YAML header or via reference WORD file.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You first change styles directly using the options made available by the <code>officedown</code> package in the YAML header <a href="#sec-change-style-yaml" class="quarto-xref"><span>Section&nbsp;7.6.1</span></a></li>
<li>If the above is not sufficient, use reference WORD file to apply its style (not content) to the output WORD file <a href="#sec-change-style-reference" class="quarto-xref"><span>Section&nbsp;7.6.2</span></a></li>
</ul>
</div>
</div>
<section id="sec-change-style-yaml" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="sec-change-style-yaml"><span class="header-section-number">7.6.1</span> Change styles in the YAML header</h3>
<p>You can control the style of the output WORD file somewhat in the YAML header. For example, you can determine the page size and margins using <code>page_size</code> and <code>page_margins</code> (see the YAML header in the sample rmd file). You also have some controls on how tables and figures appear. For example, the <code>align</code> option lets you determine the horizontal position of tables and figures. <code>topcaption</code> lets you determine whether you have the caption at the top of bottom.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-3" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-yaml.png" id="fig-539a35d47e664c97a50115a146a7f1bd-3" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the complete set of options, see <a href="https://ardata-fr.github.io/officeverse/officedown-for-word.html">Section 4 of the Officeverse book</a>.</p>
</div>
</div>
</section>
<section id="sec-change-style-reference" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="sec-change-style-reference"><span class="header-section-number">7.6.2</span> Change styles through reference docx</h3>
<p>It is almost always the case that the above approach is not sufficient to format your WORD file to the specific requirements of your target journal. In such a case, you can define the style of the output WORD file in detail using a style reference WORD file. This method can control virtually every aspect of WORD file styling. Some of the commonly customized elements among others are</p>
<ul>
<li>font size</li>
<li>font family</li>
<li>line spacing</li>
</ul>
<p>To do this, you first create a style reference word file that follows the style and format you would like the output WORD file to have. Then, add the following to the YAML header under <strong>output:</strong> like below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  reference_docx: word-style.docx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In our example project, <strong>word_template.docx</strong> is the reference file.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-4" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/yaml-reference-docx.png" id="fig-539a35d47e664c97a50115a146a7f1bd-4" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Of course, only the style and format of the reference WORD file will be inherited to the output WORD file, but not its contents.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Compared the style of <strong>sample_to_word.docx</strong> and “word_template.docx” and confirm they have the same font size and family for the narrative, sections, subsections, and subsubsection.</li>
<li>Uncomment <code>reference_docx: word_template.docx</code> in the YAML header, knit to a WORD file, and check the style of <strong>sample_to_word.dcox</strong> again</li>
</ul>
</div>
</div>
<p>You can change the style of the reference WORD style file and save the changes. Then, the style changes will be reflected in the output WORD file when the rmd file is knitted next time.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To create a style file for your liking you may find <a href="https://support.microsoft.com/en-gb/office/customize-or-create-new-styles-d38d6e47-f6fc-48eb-a607-1eb120dec563">this Microsoft tutorial</a> and <a href="https://bookdown.org/yihui/Rmarkdown-cookbook/word-template.html">this book chapter</a> in <span class="citation" data-cites="xie2020r">(<a href="C2_2_Rmarkdown_WORD.html#ref-xie2020r" role="doc-biblioref"><strong>xie2020r?</strong></a>)</span> useful.</p>
</div>
</div>
</section>
<section id="style-change-example" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="style-change-example"><span class="header-section-number">7.6.3</span> Style change example</h3>
<p>This section gives you a quick look at what it may look to be changing the style of a reference WORD file. We use <strong>word_template.docx</strong> for this demonstration. First, open the document on WORD and open the Styles Pane (If you are using Mac, it should be at the right upper corner of the document). Then you should see something like below.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Then, put your cursor on anywhere in line 2 as below and you should see that the current style is changed to “1 Heading 1”, which is the name of the class (style type) the texts in line 2 belong to.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-6" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-6" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Now, put your cursor at the black triangle and you should see available options including “Modify Style…”</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-7" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-3.png" id="fig-539a35d47e664c97a50115a146a7f1bd-7" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Once you click on it, you should see a pop-up window like below.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-8" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-4.png" id="fig-539a35d47e664c97a50115a146a7f1bd-8" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Here, you can change font family, font size, among other things. In this demonstration, let’s get rid of automatic section number. To do so, click on the “Format” button at the lower left corner of the window. Then, you should see this.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-5.png" id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Pick “Numbering,” click on “None,” and hit “OK.”</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-10" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-6.png" id="fig-539a35d47e664c97a50115a146a7f1bd-10" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Hit “OK” again in the previous pop-up window, then you should see this.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-11" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/style-change-7.png" id="fig-539a35d47e664c97a50115a146a7f1bd-11" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Notice that section numbering is now gone. Now, knit the sample rmd file and confirm that the output WORD file indeed lost section numbers (subsection numbers still remain because you did not modify that part in the reference docx.).</p>
</section>
</section>
<section id="citations-and-references" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="citations-and-references"><span class="header-section-number">7.7</span> Citations and References</h2>
<section id="set-up" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="set-up"><span class="header-section-number">7.7.1</span> Set up</h3>
<p>First, create a reference file. Then, add the following to the YAML header (not under <strong>output:</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bibliography<span class="sc">:</span> bibliography file name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are various bibliography systems that can be used including BibLaTeX/BibTex (.bib), CSL-JSON (.json), EndNote (.enl) among other.</p>
<!-- ```{r echo = F}
data.frame(
  format = c("CSL-JSON", "MODS", "BibLaTeX/BibTex", "RIS", "EndNote", "EndNote XML", "ISI", "MEDLINE", "Copac"),
  extension = c(".json", ".mods", ".bib", ".ris", ".enl", ".xml", ".wos", ".medline", ".copac")
) %>%
  flextable() %>%
  fontsize(size = 18, part = "all") %>%
  autofit()
``` -->
<p>Then, add the following to the part of rmd where you want to put references.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>:::</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In our example, we use a <strong>bib</strong> file and the bibliography file is named <strong>bibliography.bib</strong> and specified in the YAML header as below</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-12" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/yaml-bib.png" id="fig-539a35d47e664c97a50115a146a7f1bd-12" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>See the sample rmd file to see how bibliography file is specified in the YAML header</li>
<li>Confirm that <code>{#refs}</code> enclosed by <code>:::</code>is placed in the Reference section of the sample rmd file and confirm that references are indeed added in the Reference section of the output word file</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="cite-and-create-references" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="cite-and-create-references"><span class="header-section-number">7.7.2</span> Cite and create references</h3>
<p>To cite, use the following syntax:</p>
<ul>
<li><code>@reference_name</code> to print “author names (year)” in the output WORD file</li>
<li><code>[@reference_name]</code> to print “(author names, year)” in the output WORD file</li>
<li><code>[@reference_name_1; @reference_name_2]</code> to print “(author names, year; author names, year)” in the output WORD file</li>
<li><code>[-@reference_name]</code> to print just year</li>
</ul>
<p><code>reference_name</code> is the very first entry of a <strong>.bib</strong> file as in</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-13" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/bib-example.png" id="fig-539a35d47e664c97a50115a146a7f1bd-13" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>If you are using CSL json file, then it is the <strong>id</strong> of an entry as in</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-14" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/bib-csl-example.png" id="fig-539a35d47e664c97a50115a146a7f1bd-14" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>The cited items are automatically added to the reference following the specified style (see the next section).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>See the Introduction and Reference sections in the sample rmd and WORD files to confirm this rule.</li>
<li>Comment out <code>bibliography: bibliography.bib</code> and uncomment <code>bibliography: bibliography.json</code>, knit again, and check citations and references are still there. This is just an illustration of using a different bibliography file (CSL-json file).</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="citation-and-reference-style" class="level3" data-number="7.7.3">
<h3 data-number="7.7.3" class="anchored" data-anchor-id="citation-and-reference-style"><span class="header-section-number">7.7.3</span> Citation and Reference Style</h3>
<p>You can change the citation and reference style using <a href="https://citationstyles.org/">Citation Style Language</a>. Citation style files have <strong>.csl</strong> extension.</p>
<ol type="1">
<li><p>Obtain the csl file you would like to use from the <a href="https://www.zotero.org/styles">Zotero citation style repository</a>.</p></li>
<li><p>Place the following in the YAML header (not under <strong>output:</strong>):</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>csl<span class="sc">:</span> csl file name </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Then, when knitted, citations and references styles reflect the style specified by the csl file</li>
</ol>
<p>Currently, the csl style should be set to <strong>qje.csl</strong> (citation style language for The Quarterly Journal of Economics) as below</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-15" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/yaml-csl.png" id="fig-539a35d47e664c97a50115a146a7f1bd-15" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<p>Citation and references styles in the output WORD file follows the rules for the QJE.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/citation-qje.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Citation style for QJE</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/reference-qje.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Reference style for QJE</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now, comment <code>csl: qje.csl</code> and uncomment <code>csl: pnas.csl</code> so that the CSL for the Proceedings of the National Academy of Sciences (PNAS) is used, and then knit the sample rmd file.</p>
<p>You can now see that the citation style no longer respects the rules I mentioned above and also the reference style follows that of PNAS. This is because PNAS uses only numbers, but not author names or years.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/citation-pnas.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Citation style for PNAS</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/reference-pnas.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Reference style for PNAS</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="cross-ref-table-word" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="cross-ref-table-word"><span class="header-section-number">7.8</span> Tables (Cross-referenced)</h2>
<ol type="1">
<li><p>Create a table using the <code>flextable</code> package (this is not the only option, and will be discussed later)</p></li>
<li><p>Add an R code chunk like this:</p></li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, tab.id = "table-id", tab.cap = "table-name"}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="in">table_ft</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>table_ft</code> is a <code>flextable</code> object.</li>
<li><code>table-name</code> is the caption of the table in the output WORD file</li>
<li><code>table-id</code> is the table id you can use to cross-reference</li>
</ul>
<ol start="3" type="1">
<li>Use <code>\@ref(tab:table-id)</code> in the Rmarkdown file to cross-reference the table (table numbering in the output WORD file is automatic)</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You cannot use <code>_</code> in the table id (<code>-</code> is allowed). Cross-referencing would not work if the table id includes <code>_</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>See the Tables section of the sample rmd for the R codes to create a table using the <code>flextable</code> package and confirm that the table appears in the output WORD files</li>
<li>See the bottom of the Data subsection under the Materials and Methods section to confirm that cross-referencing is working.</li>
</ul>
</div>
</div>
<section id="packages-to-create-tables" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="packages-to-create-tables"><span class="header-section-number">7.8.1</span> Packages to create tables</h3>
<p>One of the disadvantages of writing to a WORD file is that some table-making R packages are not compatible with it. The <code>flextable</code> package is written by the same author of the <code>officedown</code> package, which we are using to write to a WORD file. So, naturally, a table object created by the <code>flextable</code> package (a <code>flextable</code> object) can be knitted into the output WORD without (almost) any hiccups as we saw earlier. A notable R package that does NOT work well with the output class of <code>officedown::rdocx_document</code> (which we are using) is the <code>gt</code> package. Tables created by the package is an object of class <code>gt</code>. Unfortunately, there is no function that lets you convert an <code>gt</code> object to a <code>flextable</code> object as of now.</p>
<p>One of the recommended packages is the <a href="https://vincentarelbundock.github.io/modelsummary/index.html"><code>modelsummary</code></a> package (especially for those who often include regression results tables and summary statistics tables). It lets you create regression results tables via the <code>modelsummary()</code> function and summary statistics tables via the <code>datasummary()</code> function<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Both functions has an option called <code>output</code> and you can use <code>output = "flextable"</code> to generate tables as <code>flextable</code> objects, which can then be included in the output file easily.</p>
<p>Here are some example R codes of using the <code>modelsummary</code> package to create a regression results and summary statistics tables.</p>
<p><strong>Regression</strong> table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- regressions ---#</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="ot">&lt;-</span> fixest<span class="sc">::</span><span class="fu">feols</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> cyl, <span class="at">data =</span> mtcars)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>lm_2 <span class="ot">&lt;-</span> fixest<span class="sc">::</span><span class="fu">feols</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> cyl <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>lm_3 <span class="ot">&lt;-</span> fixest<span class="sc">::</span><span class="fu">feols</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> cyl <span class="sc">+</span> wt, <span class="at">cluster =</span> <span class="sc">~</span> vs, <span class="at">data =</span> mtcars)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#--- create a regression results table ---#</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">modelsummary</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(lm_1, lm_2, lm_3),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"flextable"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"IC|Log|Adj|F|Pseudo|Within"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline</span>(<span class="dv">8</span>) <span class="co"># add horizontal line. modelsummary() adds horizontal line separating coefficient estimates and model summary statistics. But, it disappears on WORD for some reason. So, it is manually added here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Summary statistics</strong> table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">datasummary</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">+</span> hp <span class="sc">+</span> cyl <span class="sc">~</span> Mean <span class="sc">+</span> SD,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mtcars,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"flextable"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://tmieno2.github.io/AECN-Data-Science-R/Chapter-7-MakeTable_flextable/make_table_flextable_x.html?panelset6=instruction5&amp;panelset7=instruction6&amp;panelset8=introduction2&amp;panelset9=instruction7&amp;panelset10=add_*_row%28%292&amp;panelset11=instruction8#1">Here</a> is one of the resources to learn how to use the <code>flextable</code> package if you need to further modify the tables created by the <code>modelsummary()</code> and <code>datasummary()</code> functions.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>See how the exactly the same codes above in the sample rmd file translates into the regression results and summary statistics tables in the output word file.</p>
</div>
</div>
</section>
</section>
<section id="figures-cross-referenced" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="figures-cross-referenced"><span class="header-section-number">7.9</span> Figures (Cross-referenced)</h2>
<section id="figures-created-internally" class="level3" data-number="7.9.1">
<h3 data-number="7.9.1" class="anchored" data-anchor-id="figures-created-internally"><span class="header-section-number">7.9.1</span> Figures created internally</h3>
<p>You can create plots within an Rmarkdown file and display them in the output WORD file. Here are the steps.</p>
<ol type="1">
<li><p>Create a plot using R</p></li>
<li><p>Add an R code chunk like this:</p></li>
</ol>
<ul>
<li><code>figure_g</code> is a plot.</li>
<li><code>fig.cap = "caption"</code> adds <code>caption</code> as the caption of the figure</li>
<li><code>figure-id</code> is the figure id used for cross-referencing</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.id = "figure-id", fig.cap = "caption"}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="in">figure_g </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Use <code>\@ref(fig:figure-id)</code> in the Rmarkdown file to cross-reference the figure (figure numbering in the output WORD file is automatic)</li>
</ol>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rmarkdown-WORD Comparison: Visual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><br></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/figure-rmd.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Rmarkdown</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/figure-word.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>WORD</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Please do not forget to have <code>fig.cap = "caption"</code> in the R code chunk option that output a plot. Otherwise, the plot will not be recognized as a plot in the output WORD file and cross-referencing will not work even though the plot will be displayed (check to confirm this by removing <code>fig.cap = "The Distribution of Yield by Zone"</code> from the R code chunk in the Figures section of the sample WORD file).</li>
<li>You cannot use <code>_</code> in the figure id (<code>-</code> is allowed). Cross-referencing would not work if the table id includes <code>_</code>.</li>
</ul>
</div>
</div>
<p>You can control the size of the plots in the output WORD file, using the <code>fig.width</code> and <code>fig.height</code> options in the R code chunk. For example, <code>fig.width = 4</code> would mean that the width of the plot will be 4 inches. Use the <code>dpi</code> option to control the resolution of the plot. The higher the <code>dpi</code> value, the sharper the plot is.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Change <code>fig.width</code> to 2 and see what happens to the output WORD file.</li>
<li>Remove the <code>fig.cap</code> option and see what happens to the output WORD file.</li>
<li>Change the <code>dpi</code> value to 100 see what happens to the output WORD file.</li>
</ul>
</div>
</div>
</section>
<section id="importing-pre-made-figures" class="level3" data-number="7.9.2">
<h3 data-number="7.9.2" class="anchored" data-anchor-id="importing-pre-made-figures"><span class="header-section-number">7.9.2</span> Importing pre-made figures</h3>
<p>Instead of creating plots using R code inside an Rmarkdown, we often need to import figures that were made elsewhere. You may be importing your company/university logos. You may have created plots using the <code>ggplot2</code> package and saved them as pictures. In order to import a pre-made figure and cross-reference it, you can use <code>knitr::include_graphics()</code> as follows,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>```{r  echo = F, fig.id = "figure-id", fig.cap = "figure caption"}</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>knitr::include_graphics("file name")</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can cross-reference imported figures in the same manner as the R-generated figures as shown above.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rmarkdown-WORD Comparison: Visual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><br></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/figure-rmd-import.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Rmarkdown</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/figure-word-import.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>WORD</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>It is important to note that pdf files are not accepted<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. One of the accepted files types is <code>.png</code> (or <code>jpg</code>)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. So, if you are creating figures outside of the Rmarkdown file, save it as a <code>png</code> file.</p>
<p>In order to change the size of the imported figure, you can use the same R chunk option of <code>fig.width</code> and <code>fig.height</code> as the internally created plots. However, you cannot control the resolution of the imported figure using <code>dpi</code> (naturally) because the resolution of the saved image will be respected. If you are using R to create a plot, you can set its dpi when saving it. For example, if you are using <code>ggplot2</code>, you can the <code>dpi</code> option in <code>ggsave()</code> will do the job.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try!
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Change <code>fig.width = 3</code> to see its effect on the output WORD file</li>
<li>Change <code>dpi = 600</code> in the R code chunk for the second figure to confirm that it does not anything</li>
</ul>
</div>
</div>
</section>
</section>
<section id="mathematical-equations" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="mathematical-equations"><span class="header-section-number">7.10</span> Mathematical equations</h2>
<p>You can use Latex-like math syntax to write mathematical equations. For equation numbering and cross-referencing to work as discussed here, make sure that you use <code>bookdown::word_document2</code> for the <code>base_format</code> in the YAML header as below.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-16" class="quarto-figure quarto-figure-center anchored" width="100%">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="assets/pictures/yaml-math.png" id="fig-539a35d47e664c97a50115a146a7f1bd-16" class="img-fluid figure-img" style="width:100.0%">
</div>
</figure>
</div>
</div>
</div>
<section id="math-equation" class="level3" data-number="7.10.1">
<h3 data-number="7.10.1" class="anchored" data-anchor-id="math-equation"><span class="header-section-number">7.10.1</span> Math equation</h3>
<p>Math for WORD output is much more limited compared to writing to a PDF file using Latex (when knitting to a PDF file, Rmarkdown uses Latex to render math equations). This is because Latex is <strong>NOT</strong> involved in converting Latex-like math syntax to math equations when knitted to WORD. Instead, pandoc is doing the conversion job. So, it is not surprising that not all the Latex math capabilities can be utilized when knitting to a WORD file. With that said, most of the syntaxes that you will need are the same between Rmd-to-WORD and Latex. You can use the equation (for single line of math) and align (more than equal to one equations) environments with successful cross-referencing.</p>
<hr>
<p><strong>equation</strong> environment</p>
<p>To use an equation environment, first write math and then put <code>(\#eq:equation-id)</code> at the end (but before <code>\end{equation}</code>) to give an equation id to the equation. You can use <code>\@ref(eq:equation-id)</code> to cross-reference the equation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Math</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:equation-id)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>\end{equation}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>\bar{y} = \sum_{i=1}^n y_i</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:eq-1)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>\end{equation}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>should print like below in the output WORD file.</p>
<p><span class="math display">\[
\begin{equation}
\bar{y} = \sum_{i=1}^n y_i
\end{equation}
\]</span></p>
<hr>
<p><strong>align</strong> environment</p>
<p>This works just like <strong>equation</strong> environment. To use an align environment, first write line(s) of math and then put <code>(\#eq:equation-id)</code> at the end (but before <code>\end{align}</code>) to give an equation id to the equation. You can use <code>\@ref(eq:equation-id)</code> to cross-reference the equation.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Math<span class="sc">\\</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Math</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:equation-id)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>\end{align}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example,</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> AR(p): Y_i &amp;= c + \epsilon_i + \phi_i Y_{i-1} \dots <span class="sc">\\</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> Y_{i} &amp;= c + \phi_i Y_{i-1} \dots</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>\end{align}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>should print like below in the output WORD file.</p>
<p><span class="math display">\[
\begin{align}
AR(p): Y_i &amp;= c + \epsilon_i + \phi_i Y_{i-1} \dots \\
Y_{i} &amp;= c + \phi_i Y_{i-1} \dots
\end{align}
\]</span></p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rmarkdown-WORD Comparison: Visual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><br></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/math-env-rmd.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Rmarkdown</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/math-env-word.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>WORD</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="in-line-math" class="level3" data-number="7.10.2">
<h3 data-number="7.10.2" class="anchored" data-anchor-id="in-line-math"><span class="header-section-number">7.10.2</span> In-line math</h3>
<p>To write a mathematical expression in line, you can enclose math expressions by $ like below.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Our model is written as $Y_z = f_z(S) + g_z(N) + h_z(X,Y) + \varepsilon_z$.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This should appear like below in the output WORD file.</p>
<p>Our model is written as <span class="math inline">\(Y_z = f_z(S) + g_z(N) + h_z(X,Y) + \varepsilon_z\)</span>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rmarkdown-WORD Comparison: Visual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><br></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/math-inline-rmd.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Rmarkdown</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><img src="assets/pictures/math-inline-word.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>WORD</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The <a href="https://www.danieldsjoberg.com/gtsummary/index.html">gtsummary</a> package is also compatible. Use <code>as_flex_table()</code> to convert a <code>gtsummary</code> object to a <code>flextable</code> object.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If you are using Rmarkdown-PDF, you can import pdf files<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I am not aware of all the types of accepted file types.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-cacioppo2015social" class="csl-entry" role="listitem">
Cacioppo, John T, Robert M Kaplan, Jon A Krosnick, James L Olds, and
Heather Dean. 2015. <span>“Social, Behavioral, and Economic Sciences
Perspectives on Robust and Reliable Science.”</span> <em>Report of the
Subcommittee on Replicability in Science Advisory Committee to the
National Science Foundation Directorate for Social, Behavioral, and
Economic Sciences</em> 1.
</div>
</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./C2_1_IntroWriting.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./C2_3_Rmarkdown_PDF.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rmarkdown-PDF</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>